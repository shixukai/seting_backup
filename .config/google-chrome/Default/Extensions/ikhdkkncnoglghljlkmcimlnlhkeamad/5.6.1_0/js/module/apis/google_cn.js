define(["../../lib/jquery","../ga"],function(a,b){"use strict";var c={ERROR_NETWORK:"网络错误，请稍后重试",ERROR_RESPONSE:"服务器返回了错误的数据类型",ttsLink:"https://translate.google.cn/translate_tts?ie=UTF-8&q={{query}}&tl={{lang}}&client=gtx",method:"GET",url:"https://translate.google.cn/translate_a/single",data:{client:"gtx",sl:"auto",tl:"auto",hl:"zh-CN",dt:["t","bd"],dj:1,source:"icon",q:""},result2obj:function(a,d){var e={};return e.to=d.to||"auto",e.from=a.src,e.response=a,e.linkToResult=c.linkToResult.replace("{{to}}",e.to).replace("{{query}}",d.text),Array.isArray(a.dict)&&(e.detailed=[],a.dict.forEach(function(a){e.detailed.push(a.pos+"："+(a.terms.slice(0,3)||[]).join(","))}),e.detailed=e.detailed.join("<br>")),Array.isArray(a.sentences)?(e.result=[],a.sentences.forEach(function(a){e.result.push(a.trans)}),e.result=e.result.join("<br>")):(e.result="啊哦，谷歌翻译(国内)返回了一个奇怪的东西，稍后再试试看吧。",console.error("谷歌(国内)返回了错误的数据："),console.error(a),b.track("谷歌(国内)返回了错误的json结构",JSON.stringify(a))),e},linkToResult:"https://translate.google.cn/#auto/{{to}}/{{query}}"},d=Object.freeze({id:"google_cn",name:"谷歌翻译(国内)",link:"https://translate.google.cn/",translate:function(b,d){var e=a.extend({},c.data);return e.q=b.text,e.tl=b.to||"auto",a.ajax({url:c.url,type:c.method,data:a.param(e,!0),timeout:4e3}).done(function(a){var e;e="string"==typeof a?{error:"谷歌(国内)翻译发生了一个错误，可能是因为查询文本过长造成的。"}:c.result2obj(a,b),e.response=a,d(e)}).fail(function(a,b){var c;"timeout"===b?c="查询时间超过了5秒，为避免发生错误已取消此次查询，请稍后重试。":"error"===b&&(c="查询时发生了网络错误，请先检查一下你的网络设置，然后重试。"),d({error:c})}),this},detectLanguage:function(a,b,c){return d.translate({text:a},function(a){a.error?c(a):b(a.from)}),this},speakUrl:function(a,b,e){var f=c.ttsLink.replace("{{query}}",a);return b&&"auto"!==b?(f=f.replace("{{lang}}",b),e(encodeURI(f))):d.detectLanguage(a,function(a){f=f.replace("{{lang}}",a),e(encodeURI(f))}),this}});return d});