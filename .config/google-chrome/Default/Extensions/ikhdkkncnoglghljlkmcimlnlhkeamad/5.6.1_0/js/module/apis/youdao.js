define(["../../lib/jquery","./baidu","../ga"],function(a,b,c){"use strict";var d={method:"GET",url:"https://fanyi.youdao.com/openapi.do",data:{keyfrom:"chrome",key:"1361128838",type:"data",doctype:"json",version:"1.1",q:""},error:{20:"有道翻译服务一次性只能翻译200个字符哦，长文本就用百度翻译吧！",30:"你查询的文本太难了，有道翻译不出来  :( 试试百度翻译吧！",40:"有道翻译不支持这种语言哦，用百度翻译试试！",50:"天呐！由于使用右键翻译的人数过多，导致有道翻译封禁了翻译功能！请火速发送邮件至 milk.lee@qq.com 通知作者！"},result2obj:function(a,b){var e={};return e.response=a,0===a.errorCode?(e.linkToResult=d.linkToResult.replace("{{query}}",b.text),a.basic&&(Array.isArray(a.basic.explains)&&(e.detailed=a.basic.explains.join("<br>")),a.basic.phonetic&&(e.phonetic="/"+a.basic.phonetic+"/")),Array.isArray(a.translation)?e.result=a.translation.join("<br>"):(e.result="啊哦，有道翻译返回了一个奇怪的东西，稍后再重新试试看吧。",console.error("有道返回了错误的数据："),console.error(a),c.track("有道返回了错误的json结构",JSON.stringify(a)))):e.error=this.error[a.errorCode],e},ttsLink:"http://tts.youdao.com/fanyivoice?keyfrom=fanyi%2Eweb%2Eindex&le={{lang}}&word={{query}}",linkToResult:"http://fanyi.youdao.com/translate?i={{query}}"},e=Object.freeze({id:"youdao",name:"有道翻译",link:"http://fanyi.youdao.com/",translate:function(b,c){var e=a.extend({},d.data);return e.q=b.text,a.ajax({url:d.url,type:d.method,data:e,timeout:3e3}).done(function(a){var e;e="string"==typeof a?{error:"翻译服务器返回了错误的数据，请稍后重试"}:d.result2obj(a,b),e.response=a,c(e)}).fail(function(a,b){var d;"timeout"===b?d="查询时间超过了4秒，为避免发生错误已取消此次查询，请稍后重试。":"error"===b&&(d="查询时发生了网络错误，请先检查一下你的网络设置，然后重试。"),c({error:d})}),this},speakUrl:function(a,c,e){return b.detectLanguage(a,function(b){var c;b={en:"eng",jp:"jap",kor:"ko",fra:"fr"}[b],b?(c=encodeURI(d.ttsLink.replace("{{lang}}",b).replace("{{query}}",a)),e(c)):e(!1)}),this}});return e});