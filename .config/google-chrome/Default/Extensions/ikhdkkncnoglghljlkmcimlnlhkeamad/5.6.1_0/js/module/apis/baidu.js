define(["../../lib/jquery","../ga"],function(a,b){"use strict";var c={map:{en:"en",th:"th",ru:"ru",pt:"pt",de:"de",it:"it",zh:"zh","zh-CN":"zh","zh-TW":"zh",ja:"jp",ko:"kor",es:"spa",fr:"fra",ar:"ara"},error:{52001:"百度翻译忙不过来了，稍后再试试看，或者用有道翻译吧。",52002:"百度翻译出错了！用有道试试吧。",52003:"天呐！如果你看见这条错误信息，说明由于使用右键翻译的人数过多，导致百度翻译封禁了翻译功能！请火速发送邮件至 milk.lee@qq.com 反应情况！"},method:"GET",url:"https://openapi.baidu.com/public/2.0/bmt/translate",data:{client_id:"Hs18iW3px3gQ6Yfy6Za0QGg4",from:"auto",to:"auto",q:""},ttsLink:"http://fanyi.baidu.com/gettts?lan={{lang}}&text={{query}}&spd=2&source=web",linkToResult:"http://fanyi.baidu.com/#auto/{{to}}/{{query}}",result2obj:function(a,d){var e={};return a.error_code?e.error=c.error[a.error_code]:(e.to=a.to,e.from=a.from,e.response=a,e.linkToResult=c.linkToResult.replace("{{query}}",d.text).replace("{{to}}",a.to),Array.isArray(a.trans_result)?(e.result=[],a.trans_result.forEach(function(a){e.result.push(a.dst)}),e.result=e.result.join("\n")):(e.result="啊哦，百度返回了一个奇怪的东西，等一会儿再试试看吧。",console.error("百度返回了错误的数据："),console.error(a),b.track("百度返回了错误的json结构",JSON.stringify(a)))),e}},d=Object.freeze({id:"baidu",name:"百度翻译",link:"http://fanyi.baidu.com/",detectLanguage:function(b,c){return a.ajax({url:"http://fanyi.baidu.com/langdetect",type:"POST",data:"query="+b.slice(0,73)}).done(function(a){0===a.error&&c(a.lan)}),this},translate:function(b,d){var e=a.extend({},c.data);return e.q=b.text,e.to=c.map[b.to]||"auto",a.ajax({url:c.url,type:c.method,data:e,timeout:3e3}).done(function(a){var e;e="string"==typeof a?{error:"翻译服务器返回了错误的数据，请稍后重试"}:c.result2obj(a,b),e.response=a,d(e)}).fail(function(a,b){var c;"timeout"===b?c="查询时间超过了3秒，为避免发生错误已取消此次查询，请稍后重试。":"error"===b&&(c="查询时发生了网络错误，请先检查一下你的网络设置，然后重试。"),d({error:c})}),this},speakUrl:function(a,b,e){var f=c.ttsLink.replace("{{query}}",a);return b?(f=f.replace("{{lang}}",b),e(encodeURI(f))):d.detectLanguage(a,function(a){f=f.replace("{{lang}}",a),e(encodeURI(f))}),this}});return d});