if(function(){function a(b){"use strict";"Script error."===b.message&&(alert("啊哦，你当前浏览的网站不允许划词翻译使用网页翻译。"),window.removeEventListener("error",a))}window.addEventListener("error",a)}(),this.JSONDAO=this.JSON,function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSONDAO.stringify&&(JSONDAO.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSONDAO.stringify");return str("",{"":a})}),"function"!=typeof JSONDAO.parse&&(JSONDAO.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSONDAO.parse")})}(),function(){var a={browser:function(){var a,b={},c=navigator.userAgent.toLowerCase();return(a=c.match(/msie ([\d.]+)/))?b.msie=a[1]:(a=c.match(/firefox\/([\d.]+)/))?b.firefox=a[1]:(a=c.match(/chrome\/([\d.]+)/))?b.chrome=a[1]:(a=c.match(/opera.([\d.]+)/))?b.opera=a[1]:(a=c.match(/version\/([\d.]+).*safari/))?b.safari=a[1]:0,b}(),isDOM:function(a){return Boolean(a&&1===a.nodeType)},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},each:function(b,c,d){if(void 0!==b&&null!==b){if(void 0===b.length||a.isFunction(b)){for(var e in b)if(b.hasOwnProperty(e)&&c.call(d||b[e],e,b[e])===!1)break}else for(var f=0;f<b.length&&c.call(d||b[f],f,b[f])!==!1;f++);return b}},indexOf:function(b,c){if(b.indexOf)return b.indexOf(c);var d=-1;return a.each(b,function(a){return this===c?(d=a,!1):void 0}),d},bind:function(a,b,c){return c?(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c,this):void 0},unbind:function(a,b,c){return c?(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=function(){},this):void 0},param:function(b){if("string"==typeof b)return b;var c=[];return a.each(b,function(b,d){d&&(d=encodeURIComponent(d),a.browser.firefox&&(d=encodeURIComponent(unescape(d))),c.push(encodeURIComponent(b)+"="+d))}),c.join("&")},makeArray:function(a){return Array.prototype.slice.call(a,0)},getDocumentCharset:function(){return a.log("document.characterSet || document.charset:::"+document.characterSet||document.charset),document.characterSet||document.charset},log:function(){if(window.console&&window.console.log){var b=a.makeArray(arguments);b.unshift("[J]");try{window.console.log.apply(window.console,b)}catch(c){3===arguments.length?window.console.log(arguments[0],arguments[1],arguments[2]):2===arguments.length?window.console.log(arguments[0],arguments[1]):window.console.log(arguments[0])}}},css:function(){var b=function(a,b){var c="";if("float"==b&&(b=document.defaultView?"float":"styleFloat"),a.style[b])c=a.style[b];else if(a.currentStyle)c=a.currentStyle[b];else if(document.defaultView&&document.defaultView.getComputedStyle){b=b.replace(/([A-Z])/g,"-$1").toLowerCase();var d=document.defaultView.getComputedStyle(a,"");c=d&&d.getPropertyValue(b)}else c=null;if("auto"!=c&&-1===c.indexOf("%")||"width"!==b.toLowerCase()&&"height"!==b.toLowerCase()||"none"==a.style.display||-1===c.indexOf("%")||(c=a["offset"+b.charAt(0).toUpperCase()+b.substring(1).toLowerCase()]+"px"),"opacity"==b)try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity,c/=100}catch(e){try{c=a.filters("alpha").opacity}catch(f){}}return c};return function(c,d){return"string"==typeof d?b(c,d):void a.each(d,function(a,b){c.style[a]=b})}}(),getPageSize:function(){var a,b;window.innerHeight&&window.scrollMaxY?(a=document.body.scrollWidth,b=window.innerHeight+window.scrollMaxY):(a=Math.max(document.body.scrollWidth,document.body.offsetWidth),b=Math.max(document.body.scrollHeight,document.body.offsetHeight));var c,d;c=document.documentElement.clientWidth||document.body.clientWidth,d=document.documentElement.clientHeight||document.body.clientHeight;var e=Math.max(b,d),f=Math.max(a,c);return{page:{width:f,height:e},window:{width:c,height:d}}},findPos:function(b){var c={x:0,y:0};if(document.documentElement.getBoundingClientRect())c.x=b.getBoundingClientRect().left+a.scroll().left,c.y=b.getBoundingClientRect().top+a.scroll().top;else for(;b;)c.x+=b.offsetLeft,c.y+=b.offsetTop,b=b.offsetParent;return c},textPos:function(b,c){var d=b||window.event,e={},f={},g=c.h,h=c.v||"bottom";if(window.getSelection?e=window.getSelection().getRangeAt(0):document.selection&&(e=document.selection.createRange()),g?f.x=i[g]+a.scroll().left:d.pageX||d.pageY?f.x=d.pageX:(d.clientX||d.clientY)&&(f.x=d.clientX+a.scroll().left),e.getBoundingClientRect){var i=e.getBoundingClientRect();f.y=i[h]+a.scroll().top}else d.pageX||d.pageY?f.y=d.pageY:(d.clientX||d.clientY)&&(f.y=d.clientY+a.scroll().top);return f},scroll:function(){return{left:document.documentElement.scrollLeft+document.body.scrollLeft,top:document.documentElement.scrollTop+document.body.scrollTop}},walkTheDOM:function(a,b,c){if((!c||c(a))&&(b(a),"NOSCRIPT"!==a.tagName&&"IFRAME"!==a.tagName&&"FRAME"!==a.tagName))for(a=a.firstChild;a;)arguments.callee(a,b,c),a=a.nextSibling},getTextNodes:function(b,c){var d=[];return a.walkTheDOM(b,function(b){3===b.nodeType&&a.trim(b.nodeValue)&&d.push(b)},c),d},getElementsByClassName:function(b,c){if(b.getElementsByClassName)return b.getElementsByClassName(c);var d=[];return a.walkTheDOM(b,function(b){a.hasClass(b,c)&&d.push(b)}),d},query:function(b,c){var d=new RegExp("(?:(?:\\.([^()]+))?)(?:(?:#([^()]+))?)"),e=d.exec(b),f=c||document;if(!e)return null;if(e[1]){var g=e[1];if(f.getElementsByClassName)return f.getElementsByClassName(g);var h=[];return a.walkTheDOM(f,function(b){a.hasClass(b,g)&&h.push(b)}),h}return e[2]?f.getElementById(e[2]):void 0},trim:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")},formatTemplate:function(a,b){var c=document.createElement("div");for(var d in b)b.hasOwnProperty(d)&&(a=a.replace(new RegExp("{"+d+"}","g"),b[d]));c.innerHTML=a;var e=c.firstChild;return c.removeChild(e),e},hasClass:function(b,c){if(a.isDOM(b)){if(b.className===c)return!0;for(var d=b.className.split(" "),e=0,f=d.length;f>e;e++)if(c===d[e])return!0}return!1},loadCSS:function(b,c){var d=function(a){if(b&&b.createElement){var c=(Date.parse(new Date),b.createElement("link")),d=-1===a.indexOf("?")?a+"?543853":a+"&543853";c.setAttribute("rel","stylesheet"),c.setAttribute("href",d),c.setAttribute("type","text/css");var e=b.getElementsByTagName("head")[0]||b.body;e.appendChild(c)}};a.isArray(c)?a.each(c,function(a,b){d(b)}):"string"==typeof c&&d(c)},addClass:function(b,c){if(a.isDOM(b)){for(var d=b.className.split(" "),e=0,f=d.length;f>e;e++)if(c===d[e])return;d[e]=c,b.className=d.join(" ")}},removeClass:function(b,c){if(a.isDOM(b)){for(var d=b.className.split(" "),e=0,f=d.length,g=[];f>e;e++)c!==d[e]&&g.push(d[e]);b.className=g.join(" ")}},toggleClass:function(b,c){if(a.isDOM(b)){for(var d=b.className.split(" "),e=0,f=d.length,g=[],h="add";f>e;e++)c===d[e]?h="remove":g.push(d[e]);"add"===h?d[e]=c:d=g,b.className=d.join(" ")}},guid:function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}(),protoExtend:function(b,c){var d=a.isFunction(c)?c:function(){};return d.prototype=b,new d},stopPropagation:function(a){var b=a||window.event;return b.stopPropagation&&b.stopPropagation(),b.cancelBubble=!0,b},storage:function(a,b){var c=function(a,b){var c=window.localStorage;return void 0===b?c.getItem(a):void 0!==a&&void 0!==b?(c.setItem(a,b),b):void 0},d=function(a,b){var c=document.documentElement;return c.addBehavior("#default#userData"),void 0===b?(c.load("fanyiweb2"),c.getAttribute(a)):void 0!==a&&void 0!==b?(c.setAttribute(a,b),c.save("fanyiweb2"),b):void 0};return window.localStorage?c(a,b):document.documentElement.addBehavior?d(a,b):void 0},cookie:function(a,b){function c(a,b){var c=30,d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3),document.cookie=a+"="+b+";expire*="+d.toGMTString()}function d(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=b?decodeURIComponent(b[2]):null}return b?void c(a,b):d(a)},parseData:function(){var b={json:function(b){try{return b=JSONDAO.parse(b)}catch(c){a.log("[Error]","Invalid JSON data:",b)}},xml:function(a){if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b}};return function(c,d){return void 0===c?d:a.isFunction(c)?c(d):c&&!b[c]?(a.log("[Error]","Function parseData() dosen't support this type:",c),d):b[c](d)}}(),once:function(b){return function(){a.isFunction(b)&&b.apply(this,arguments),b=function(){}}}};window.J=a}(),function(a){var b=function(a,c,d){return new b.prototype.init(a,c,d)};b.prototype={init:function(a,b,c){var d=this,e=[],f=function(a){for(d.ajax=a;e.length>0;)a(e.pop())};return window.postMessage?this.createMessageChannel(a,b,c,f):this.createJTRAssist(a,f),this.ajax=function(a){return e.push(a),this},this},createMessageChannel:function(b,c,d,e){var f=this,g=function(){if(a.isDOM(a.query("#"+b)))throw new Error("Existed CDA iFrame element");if(c&&d){var e=document.createElement("iframe");return e.setAttribute("id",b),e.className="OUTFOX_JTR_CONN",e.style.display="none",e.setAttribute("src",c+d),document.body.appendChild(e),e.contentWindow}throw new Error("Empty domain is not allowed")}(),h=function(){var b=[],d=0,h={transferStationReady:function(){e(function(e){return e.data=a.param(e.data),e.index=d++,b[e.index]={dataType:e.dataType,callback:e.callback},delete e.callback,g.postMessage(JSONDAO.stringify(e),c),f})},dataBack:function(c){if(c&&b[c.index]){var d=b[c.index];a.isFunction(d.callback)&&d.callback(a.parseData(d.dataType,c.response)),delete b[c.index]}}};return function(a){if(a.origin===c){var b=JSONDAO.parse(a.data);h[b.handler](JSONDAO.parse(a.data))}}}();a.bind(window,"message",function(a){h.call(f,a)})},createJTRAssist:function(b,c){var d=this,e="https://fanyi.youdao.com/web2/JTRAssist.swf?"+ +new Date,f=function(){if(!a.query("#"+b)){var c=document.createElement("div");c.innerHTML="6.0"===a.browser.msie||"7.0"===a.browser.msie?'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1" id="'+b+'"><param name="allowScriptAccess" value="always" /><param name="movie" value="'+e+'" /></object>':'<object height="1" width="1" id="'+b+'" data="'+e+'"><param name="allowScriptAccess" value="always"></object>',document.body.appendChild(c)}},g="outfox_jtr_fproxy_callback_",h=0,i=function(c){var e=g+h++;window[e]=function(b){c.callback.call(d,a.parseData(c.dataType,decodeURI(b)))},a.query("#"+b).load(c.url,c.data,c.type||"POST",'window["'+e+'"]')},j=function(c){var d=c.data.key,e=c.data.value;void 0===e?a.isFunction(c.callback)&&c.callback(a.parseData(c.dataType,a.query("#"+b).getItem(d))):a.query("#"+b).setItem(d,e)};f(),window.JTRAssistIsReady=function(){c(function(b){switch(b.handler){case"translate":b.data=a.param(b.data),i(b);break;case"localStorage":j(b);break;default:throw new Error("Unsupported request type :"+b.handler)}return d})}}},b.prototype.init.prototype=b.prototype,a.CDA=b}(J),function(a){TR=function(b,c,d,e){this._manager=e,this._reqSize=c.reqSize,this._onStatusChange=c.onStatusChange||function(){},this._url=c.url,this.conn=d,this._context=b,this._request=function(a,b,c){d.ajax({url:a,handler:"translate",type:"POST",data:b,callback:c,dataType:"json"})};var f=new a.Page(b),g=[],h=f.getMainArticle();h&&(g=a.getTextNodes(h.elem,TR.isInclude)),this.mainNodeLength=g.length||null,this._nodeIndex=[],g=g.concat(a.getTextNodes(b,function(a){return a!==(h&&h.elem)&&TR.isInclude(a)})),a.each(g,function(a,b){this._nodeIndex.push(this._manager.addNode(b))},this),this.workingThread=0,this.guid=c.guid||a.guid()},TR.prototype={doTrans:function(){for(var b=++this.workingThread,c={ue:a.getDocumentCharset()||null,data:null,relatedUrl:document.location.href,guid:this.guid,mainLength:this.mainNodeLength,requestId:a.guid()},d=[],e=0,f=0;f<this._nodeIndex.length;f++)if(this._manager.transResults[f])b===this.workingThread&&this._manager.replaceTrans(f);else{var g=null;g=d[parseInt(e/this._reqSize,10)]?d[parseInt(e++/this._reqSize,10)]:d[parseInt(e++/this._reqSize,10)]={};var h=null;try{h=this._manager.nodes[f].parentNode&&this._manager.nodes[f].parentNode.tagName||null}catch(i){}g[f]={src:this._manager.originals[f],tag:h}}if(0===d.length)return void this._onStatusChange({id:b,action:"TRANS",level:"0",status:"finish"});var j=this,k=function(a){j._onStatusChange({id:b,action:"TRANS",level:"0",status:"busy",data:[a,d.length]}),c.data=JSONDAO.stringify(d[a]),j._request(j._url.textTrans,c,function(c){j._updateTrans(c,b),++a<d.length?k(a):j._onStatusChange({id:b,action:"TRANS",level:"0",status:"finish"})})};k(0)},revertTrans:function(){for(var a=++this.workingThread,b=0;b<this._nodeIndex.length;b++)a===this.workingThread&&this._manager.revertTrans(this._nodeIndex[b])},_updateTrans:function(b,c){return b?40===b.errorCode&&30===b.errorCode?void a.log("Get Error Code:",b.errorCode):void a.each(b.data,function(a,b){this._manager.transResults[a]=b.tst,c===this.workingThread&&this._manager.replaceTrans(a)},this):void 0},doTips:function(b){for(var c=++this.workingThread,d={type:"X",ue:a.getDocumentCharset()||null,data:null,relatedUrl:document.location.href,mainLength:this.mainNodeLength,guid:this.guid},e=[],f=0,g=0;g<this._nodeIndex.length;g++)if(this._manager.tipsResults[g])c===this.workingThread&&this._manager.replaceTips(g,b);else{var h=null;h=e[parseInt(f/this._reqSize,10)]?e[parseInt(f++/this._reqSize,10)]:e[parseInt(f++/this._reqSize,10)]={};var i=null;try{i=this._manager.nodes[g].parentNode&&this._manager.nodes[g].parentNode.tagName||null}catch(j){}h[g]={src:this._manager.originals[g],tag:i}}if(0===e.length)return void this._onStatusChange({id:c,action:"TIPS",level:b,status:"finish"});var k=this,l=function(f){a.log("Send:",e[f]),k._onStatusChange({id:c,action:"TIPS",level:b,data:[f,e.length],status:"busy"}),d.data=JSONDAO.stringify(e[f]),k._request(k._url.tips,d,function(a){k._updateTips(a,c,b),++f<e.length?l(f):k._onStatusChange({id:c,action:"TIPS",level:b,status:"finish"})})};l(0)},revertTips:function(){for(var a=++this.workingThread,b=0;b<this._nodeIndex.length;b++)a===this.workingThread&&this._manager.revertTips(this._nodeIndex[b])},_updateTips:function(b,c,d){if(b){if(40===b.errorCode&&30===b.errorCode)return void a.log("Get Error Code:",b.errorCode);var e=function(a,b){return a.start>b.start};a.each(b.data,function(a,b){b.length>0?(this._bubbleSort(b,e),this._manager.tipsResults[a]=b,c===this.workingThread&&this._manager.replaceTips(a,d)):this._manager.tipsResults[a]=[]},this)}},_bubbleSort:function(a,b){for(var c=a.length-2;c>=0;c--)for(var d=0;c>=d;d++)if(b(a[d+1],a[d])){var e=a[d];a[d]=a[d+1],a[d+1]=e}return a}},TR.isInclude=function(a){return!("SCRIPT"===a.tagName||"STYLE"===a.tagName||"PRE"===a.tagName||a.className&&-1!==a.className.indexOf("OUTFOX_JTR_"))},a.TR=TR}(J),!J||!J.bind)throw new Error("swipe extension need J.bind support");!function(a){var b="https://fanyi.youdao.com",c=b+"/fsearch",d=b+"/translate",e=function(a){return'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" width="15px" height="15px" align="absmiddle" id="speach_flash"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="https://cidian.youdao.com/chromeplus/voice.swf" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="high" /><param name="wmode"  value="transparent"><param name="FlashVars" value="audio='+a+'"><embed wmode="transparent" play="false" src="https://cidian.youdao.com/chromeplus/voice.swf" loop="false" menu="false" quality="high" bgcolor="#ffffff" width="15" height="15" align="absmiddle" allowScriptAccess="sameDomain" FlashVars="audio='+a+'" type="application/x-shockwave-flash" pluginspage="https://www.macromedia.com/go/getflashplayer" /></object>'},f=function(a){return a.split&&a.split(" ").length||0},g={isJapanese:function(a){return!Boolean(/[^\u0800-\u4e00]/.test(a))},isContainJapanese:function(a){for(var b=0,c=0;c<a.length;c++)this.isJapanese(a.charAt(c))&&b++;return b>2},isKoera:function(a){for(i=0;i<a.length;i++)if(a.charCodeAt(i)>12592&&a.charCodeAt(i)<12687||a.charCodeAt(i)>=44032&&a.charCodeAt(i)<=55203)return!0;return!1},isContainKoera:function(a){for(var b=0,c=0;c<a.length;c++)this.isKoera(a.charAt(c))&&b++;return b>0},isChinese:function(a){return!Boolean(/[^\u4e00-\u9fa5]/.test(a))},isContainChinese:function(a){for(var b=0,c=0;c<a.length;c++)this.isChinese(a.charAt(c))&&b++;return b>5}},h=function(a,b){return new h.fn.init(a,b)};h.fn=h.prototype={init:function(b,c){var d=this;this.wrapper=h.createFrameWrapper(),this.conn=h.initConnection(c),this.context=b,a.bind(document.body,"click",function(a){a||window.event;d.wrapper.style.display="none",d.wrapper.style.position="absolute",d.wrapper.innerHTML=""})},enableSwipe:function(){if(!this._swipeListener){var b=this;this._swipeListener=function(a){b._onSwipe.call(b,a)},a.bind(this.context,"mouseup",this._swipeListener)}},disableSwipe:function(){this._swipeListener&&(a.unbind(this.context,"mouseup",this._swipeListener),delete this._swipeListener)},_onSwipe:function(b){var c="",d="";window.getSelection?c=window.getSelection():document.selection&&(c=document.selection.createRange()),c.toString?d=c.toString():c.text&&(d=c.text.toString());var e=a.textPos(b,{});d=a.trim(d),h.validateSwipeWord(d)&&(this.swipeWord(d,e.x,e.y),this.onSwipeCallback&&this.onSwipeCallback(d))},swipeWord:function(a,b,c,d,e){var i=this,j=null;this.wrapper.innerHTML="",j=!g.isContainChinese(a)&&f(a)>=3||g.isContainChinese(a)||g.isContainJapanese(a)&&a.length>4?"translate":"dict",this.conn.request({action:j,word:a},function(a){i.wrapper.innerHTML="",i._onResponse.call(i,a),h.initWrapper(i.wrapper,b,c,d,e)})},_onResponse:function(a){var b=a.firstChild,c=null;if(b){switch(b.baseName&&"xml"==b.baseName&&(b=b.nextSibling),b.tagName){case"response":c=h.processXmlTransData(a);break;case"yodaodict":c=h.processXmlDictData(a);break;default:throw new Error("Incorrect xml data")}c&&(this.wrapper.appendChild(c),this.wrapper.style.display="block")}}},h.createFrameWrapper=function(){var b=document.createElement("div");return b.id="yddWrapper",a.bind(b,"click",function(b){a.stopPropagation(b)}),a.bind(b,"mouseup",function(b){a.stopPropagation(b)}),document.body.appendChild(b),b},h.validateSwipeWord=function(a){return!(""===a||a.length>2e3)},h.initConnection=function(e){var f=null,g=function(a){var b=null,e=null;return"dict"==a.action?(e={client:"JTRHelper",keyfrom:"JTRHelper.bookmark",q:a.word,pos:-1,doctype:"xml",xmlVersion:"3.2",dogVersion:"1.0",vendor:"jtr",le:"eng"},b=c):(e={client:"JTRHelper",keyfrom:"JTRHelper.bookmark",i:a.word,doctype:"xml",xmlVersion:"1.1",dogVersion:"1.0"},b=d),[b,e]};if(window.chrome&&window.chrome.extension&&window.chrome.extension.sendRequest)return f={request:function(a,b){window.chrome.extension.sendRequest(a,function(a){a&&b((new DOMParser).parseFromString(a,"text/xml"))})}};if(e)return f={request:function(a,b){var c=g(a);e.ajax({url:c[0],handler:"translate",data:c[1],callback:b,dataType:"xml",type:"POST"})}};if(a.CDA){var h=null;try{h=a.CDA("_OUTFOX_JTR_SWIPE_CONN",b,CONN_FILE_PATH)}catch(i){throw new Error("Unable to get cross-domain ajax file.")}return f={request:function(a,b){var c=g(a);h.ajax({url:c[0],handler:"translate",data:c[1],callback:b,dataType:"xml",type:"POST"})}}}throw new Error("Unable to initialize cross-domain connection port.")},h.initWrapper=function(b,c,d,e,f){var g=0,h=0,i=50,j=a.scroll().top,k=a.scroll().left,l=b.clientHeight,m=b.clientWidth,n=(a.getPageSize().window.height,a.getPageSize().window.width);e=e||0,f=f||0,h=d-l>=j+i?d-l:d+f,g=n+k>=c+m?c+e:n+k-m;var o=!("static"===a.css(document.body,"position")),p=a.css(document.body,"marginLeft"),q=a.css(document.body,"marginRight");if("auto"===p&&"auto"===q){var r=a.getPageSize().page.width,s=parseInt(a.css(document.body,"width"));p=r>s?(r-s)/2:0}p=o?parseInt(p):0;var t=o?parseInt(a.css(document.body,"marginTop")):0;a.css(b,{position:"absolute",left:g-p+"px",top:h-t+"px"})},h.processXmlTransData=function(b){var c=(b.getElementsByTagName("input")[0].childNodes[1]||b.getElementsByTagName("input")[0].childNodes[0]).nodeValue,d=(b.getElementsByTagName("translation")[0].childNodes[1]||b.getElementsByTagName("translation")[0].childNodes[0]).nodeValue,e=(b.getElementsByTagName("response")[0].getAttribute("errorCode")-0,a.trim(d)),f=a.trim(c);if((g.isContainChinese(f)||g.isContainJapanese(f)||g.isContainKoera(f))&&f.length>15?f=f.substring(0,8)+" ...":f.length>25&&(f=f.substring(0,15)+" ..."),f==e)return null;var h="https://fanyi.youdao.com/translate?i="+encodeURIComponent(c)+"&keyfrom=chrome",i='<div class="ydd-container">                          <div class="ydd-top-wrapper">                            <div class="ydd-top">                            </div>                          </div>                          <div class="ydd-body-wrapper">                            <div class="ydd-lb"></div>                            <div class="ydd-rb"></div>                            <div class="ydd-body">                              <div class="ydd-titile">                                <span>{input}</span>                                <span><a href="{searchURL}" target="_blank">详细&rsaquo;&rsaquo;</a></span>                              </div>                              <div class="ydd-middle">                                <div class="ydd-trans-wrapper ydd-simple-trans">                                  <div class="ydd-trans-container">{trans}</div>                                </div>                              </div>                            </div>                          </div>                          <div class="ydd-bottom-wrapper"><div class="ydd-bottom"></div></div>                          <div class="ydd-bg-top"></div></div>                        </div>';return a.formatTemplate(i,{searchURL:h,input:f,trans:d})},h.processXmlDictData=function(b){var c=null,d=null,f=[],h=[],i="",j="",k="",l="",m=0,n=function(a){try{return b.getElementsByTagName(a)[0].firstChild.nodeValue}catch(c){return""}};if(i=n("return-phrase"),j=n("dictcn-speach"),k=n("lang"),l=n("phonetic-symbol"),(d=b.getElementsByTagName("translation"))&&d.length>0)for(m=0;m<d.length;m++)f.push(d[m].getElementsByTagName("content")[0].firstChild.nodeValue);if((c=b.getElementsByTagName("web-translation"))&&c.length>0)for(m=0;m<c.length-1;m++)h.push({key:c[m].getElementsByTagName("key")[0].firstChild.nodeValue,value:c[m].getElementsByTagName("trans")[0].getElementsByTagName("value")[0].firstChild.nodeValue});var o="https://dict.youdao.com/search?q="+encodeURIComponent(i)+"&keyfrom=chrome.extension"+k,p=i,q="",r="",s="",t=null,u="https://www.youdao.com/search?q={title}&keyfrom=fanyi.jtr",v="";for(v='<div class="ydd-container">                      <div class="ydd-top-wrapper">                        <div class="ydd-top"></div>                      </div>                      <div class="ydd-body-wrapper">                        <div class="ydd-lb"></div>                        <div class="ydd-rb"></div>                        <div class="ydd-body">                          <div class="ydd-titile">                            <span class="ydd-key-title">{title}</span>                            <span class="ydd-phonetic">{phonetic}</span> {speechHTML} <span class="ydd-detail"><a href="{searchURL}" target="_blank">详细&rsaquo;&rsaquo;</a></span>                          </div>                          <div class="ydd-middle">                            <div class="ydd-trans-wrapper ydd-base-trans">                              <div class="ydd-tabs"><span class="ydd-tab">基本翻译</span></div>{baseTransHTML}</div>                              <div class="ydd-trans-wrapper ydd-web-trans">                                <div class="ydd-tabs"><span class="ydd-tab">网络释义</span></div>{webTransHTML}</div>                              </div>                            </div>                          </div>                        <div class="ydd-bottom-wrapper">                          <div class="ydd-bottom"><a href="'+u+'" target="_blank" title="使用有道搜索 {title}">搜索&nbsp;{title}</a></div>                        </div>                        <div class="ydd-bg-top"></div>                      </div>                    </div>',(g.isContainChinese(p)||g.isContainJapanese(p)||g.isContainKoera(p))&&p.length>15?p=p.substring(0,10)+"...":p.length>25&&(p=p.substring(0,15)+" ..."),f.length+h.length>0&&j&&(q='<span class="ydd-voice">'+e("https://dict.youdao.com/speech?audio="+j,"test","CLICK","dictcn_speech")+"</span>"),m=0;m<f.length;m++)r+='<div class="ydd-trans-container">'+f[m]+"</div>";for(m=0;m<h.length;m++){var w="https://dict.youdao.com/search?q="+encodeURIComponent(h[m].key)+"&keyfrom=chrome.extension"+k;s+='<div class="ydd-trans-container"><a href="'+w+'" target="_blank">'+h[m].key+":</a> "+h[m].value+"</div>"}t=a.formatTemplate(v,{phonetic:l?"["+l+"]":"",title:p,searchURL:o,speechHTML:q,baseTransHTML:r,webTransHTML:s});var x=a.query(".ydd-middle",t)[0];d=a.query(".ydd-base-trans",x)[0],c=a.query(".ydd-web-trans",x)[0],f.length+h.length===0&&(x.innerHTML='<p class="ydd-no-result">没有英汉互译结果</p>');try{0===f.length?x.removeChild(d):0===h.length&&x.removeChild(c)}catch(y){}return t},h.fn.init.prototype=h.fn,a.Swipe=h}(J),function(a){var b=function(b,c,d){var e=this;if(!a.isDOM(b))throw Error("Invalid slider container element");if(this.container=b,!a.isDOM(c))throw Error("Invalid slider controller block element");this.controller=c;for(var f=this.container;f;f=f.parentNode)if(9===f.nodeType){this.document=f;break}if(!f)throw Error("Can't find parent Document element of container, container dom node should insert to document first");if(this.bar=a.isDOM(d.bar)?d.bar:null,this.range=Number(d.max-d.min),!(this.range&&this.range>0))throw Error("range must greater than 0");a.isFunction(d.callback)&&(this.callback=function(a){d.callback.call(e,a)}),this.borderFix=Number(d.borderFix)||0,this.mousemove=function(a){e._mousemove(a)},this.mouseup=function(a){e._mouseup(a)},this.mousedown=function(a){e._mousedown(a)}};b.prototype={enable:function(){a.bind(this.container,"mousedown",this.mousedown)},disable:function(){a.unbind(this.container,"mousedown",this.mousedown)},to:function(a){var b=this,c=null;(tempFunc=function(){if(!b.container.offsetHeight||!b.container.clientWidth)return void(c=setTimeout(tempFunc,200));var d=b.container.clientWidth-b.controller.clientWidth-2*b.borderFix;pos=a/b.range*d,b._valueChange(pos/d*b.range,pos)})()},_mousemove:function(a){var b=a||window.event;this._moveHandler(b,!1)},_mouseup:function(b){var c=b||window.event;this._moveHandler(c,!0),a.unbind(this.document,"mouseup",this.mouseup),a.unbind(this.document,"mousemove",this.mousemove),this.container.style.cursor="pointer"},_mousedown:function(b){var c=b||window.event;this._moveHandler(c,!1),a.bind(this.document,"mouseup",this.mouseup),a.bind(this.document,"mousemove",this.mousemove),c.preventDefault&&c.preventDefault(),c.returnValue=!1},_moveHandler:function(b,c){var d=b.clientX-.5*this.controller.clientWidth-a.findPos(this.container).x-this.borderFix,e=this.container.clientWidth-this.controller.clientWidth-2*this.borderFix,f=e/this.range,g=f/2,h=d%f,i=0;0>d?(d=0,h=0):d>e&&(d=e,h=0),i=c&&g>h?d-h:c&&h>f-g?d-h+f:d,this._valueChange(i/e*this.range,i)},_valueChange:function(a,b){this.callback(a),this.controller.style.left=b+this.borderFix+"px",this.bar&&(this.bar.style.width=b+this.controller.clientWidth/2+"px")}},a.Slider=b}(J),function(a){var b=function(){this.nodes=[],this.originals={},this.transResults={},this.tipsResults={}};b.prototype={addNode:function(a,b){var c=0;if(!b)for(;c<this.nodes.length;c++)if(this.nodes[c]===a)return c;return this.nodes.push(a),this.originals[c]=a.nodeValue,c},replaceTrans:function(a){if(this.nodes[a]&&this.transResults[a]){var b=this.nodes[a],c=document.createElement("font"),d=this.transResults[a];try{if(b.nodeValue===d)return!1;if(!b.parentNode)return}catch(e){return}b.nodeValue="",c.className="OUTFOX_JTR_TRANS_NODE",c.id="OUTFOX_JTR_TRANS_NODE-"+a,c.setAttribute("rel",a),c.innerHTML=d;try{b.parentNode.insertBefore(c,b.nextSibling)}catch(f){}}},revertTrans:function(b){if(this.nodes[b]&&this.originals[b]){var c=a.query("#OUTFOX_JTR_TRANS_NODE-"+b);c&&c.parentNode&&c.parentNode.removeChild(c);try{this.nodes[b].nodeValue=this.originals[b]}catch(d){}}},replaceTips:function(b,c){var d=c||-1;this.nodes[b]&&this.tipsResults[b]&&a.each(this.tipsResults[b],function(a,c){if(!(c.level&&c.level<d)){var e=this.nodes[b],f=c.start,g=c.end,h=c.explain;if(void 0!==typeof e.parentNode){var i=document.createElement("font");i.className="OUTFOX_NANCI_WRAPPER";try{var j=e.nodeValue.substr(0,f),k=e.nodeValue.substr(f,g-f),l=e.nodeValue.substr(g);e.nodeValue=j,i.innerHTML=k,e.parentNode.insertBefore(document.createTextNode(l),e.nextSibling),e.parentNode.insertBefore(i,e.nextSibling);var m=document.createElement("font");m.className="OUTFOX_NANCI_TIPS",m.setAttribute("rel",b),m.innerHTML="("+h+")",i.parentNode.insertBefore(m,i.nextSibling)}catch(n){}}}},this)},revertTips:function(a){if(this.nodes[a]){var b;do try{b=!this.revertTip(this.nodes[a].nextSibling)}catch(c){b=!0}while(!b)}},revertTip:function(b){if(a.hasClass(b,"OUTFOX_NANCI_WRAPPER")&&b.firstChild){var c=b.nextSibling;
return a.hasClass(c,"OUTFOX_NANCI_TIPS")&&c.parentNode.removeChild(c),b.nextSibling&&3===b.nextSibling.nodeType&&(b.firstChild.nodeValue+=b.nextSibling.nodeValue,b.parentNode.removeChild(b.nextSibling)),b.previousSibling&&3===b.previousSibling.nodeType&&(b.previousSibling.nodeValue+=b.firstChild.nodeValue,b.parentNode.removeChild(b)),!0}return!1},countTips:function(b){var c=0;return a.each(this.tipsResults,function(a,d){for(var e=0;e<d.length;e++)d[e].level>=b&&c++},this),c}},a.NodeManager=b}(J),function(a){var b=function(){this.map={},this.dataMap={}};b.prototype={getId:function(b){var c=null;return a.each(this.map,function(a,d){return d===b?(c=a,!1):void 0}),null===c&&(c=a.guid(),this.map[c]=b),c},data:function(a,b,c){var d=this.getId(a);if(3===arguments.length)return this.dataMap[d]||(this.dataMap[d]={}),this.dataMap[d][b]=c,c;var e=null;try{e=this.dataMap[d][b]}catch(f){e=void 0}return e}},a.Cache=b}(J),function(a){var b=function(b){this.contentDocument=b,this.cache=new a.Cache};b.prototype={IGNORE_TAGS:["HTML","HEAD","META","TITLE","SCRIPT","STYLE","LINK","IMG","FORM","INPUT","BUTTON","TEXTAREA","SELECT","OPTION","LABEL","IFRAME","UL","OL","LI","DD","DT","A","OBJECT","PARAM","EMBED","NOSCRIPT","EM","B","STRONG","I","INS","BR","HR","PRE","H1","H2","H3","H4","H5","CITE"],getMainArticle:function(){return null},_getAllArticle:function(){for(var a=this.contentDocument.getElementsByTagName("*"),b=[],d=0,e=a.length>100?100:a.length;e>d;d++){var f=a[d];this._checkTagName(f)&&this._checkSize(f)&&this._checkVisibility(f)&&(b[b.length]=new c(f))}return b},_checkTagName:function(b){return-1==a.indexOf(this.IGNORE_TAGS,b.tagName)},_checkVisibility:function(b){return!("hidden"==a.css(b,"visibility")||"none"==a.css(b,"display")||parseInt(a.css(b,"height"))<=0||parseInt(a.css(b,"width"))<=0)},_checkSize:function(a){return a.offsetWidth>300&&a.offsetHeight>200}};var c=function(a){this.elem=a,this._texts=this._getAllTexts(),this.weight=this.calcWeight()};c.prototype={IGNORE_TAGS:["A","DD","DT","OL","OPTION","PRE","SCRIPT","STYLE","UL","IFRAME"],MINOR_REGEXP:/comment|combx|disqus|foot|header|menu|rss|shoutbox|sidebar|sponsor/i,MAJOR_REGEXP:/article|entry|post|body|column|main|content/i,TINY_REGEXP:/comment/i,BLANK_REGEXP:/\S/i,_getAllTexts:function(){for(var b=[],c=a.getTextNodes(this.elem),d=0,e=c.length;e>d;d++){var f=c[d];if(this._checkTagName(f)&&this._checkLength(f)){var g=f.parentNode||{},h=g.parentNode||{};this._checkMinorContent(g)||this._checkMinorContent(h)||b.push(f)}}return b},calcStructWeight:function(){for(var a=0,b=0,c=this._texts.length;c>b;b++){var d=this._texts[b],e=d.nodeValue.length,f=1;if(!(e>20)){for(var g=d.parentNode;g&&g!=this.elem;g=g.parentNode)f-=.1;a+=Math.pow(e*f,1.25)}}return a},calcContentWeight:function(){for(var a=1,b=this.elem;b;b=b.parentNode){var c=b.id+" "+b.className;this.MAJOR_REGEXP.test(c)&&(a+=.4),this.MINOR_REGEXP.test(c)&&(a-=.8)}return a},calcWeight:function(){return this.calcStructWeight()*this.calcContentWeight()},_checkTagName:function(b){return-1==a.indexOf(this.IGNORE_TAGS,b.tagName)},_checkLength:function(a){return Boolean(this.BLANK_REGEXP.test(a.nodeValue))},_checkMinorContent:function(a){return Boolean(this.TINY_REGEXP.test(a.id+" "+a.className))}},a.Page=b}(J),function(a){var b={runCount:0,swipe:!0,mode:"TIPS",level:1},c={0:["TIPS",3],1:["TIPS",2],2:["TIPS",1],3:["TRANS","0"],4:["NONE","NONE"]};a.TR.UI=function(b,d){var e=this;this.initLogger(d.logURL),this.log({action:"start"}),this.guid=a.guid(),this.context=b,this.conn=a.CDA("OUTFOX_JTR_CDA",d.domain,d.connFilePath),this.update=d.update,this.updateTipMsg=d.updateTipMsg,this.updateDate=d.updateDate,this.manager=new a.NodeManager,this.barHeight=50,this.permissionDenied="由于该网页存在安全性限制, 无法加载有道网页翻译2.0",this.translator=new a.TR(b,{reqSize:d.reqSize,onStatusChange:function(){e._trStatusChangeCallback.apply(e,arguments)},url:{textTrans:d.transURL,tips:d.tipsURL},guid:this.guid},this.conn,this.manager),this.queue={TRANS:{0:{currentThread:-1}},TIPS:{1:{currentThread:-1},2:{currentThread:-1},3:{currentThread:-1}},NONE:{NONE:{}}},this.mode=null,this.level=null,this.initFrame(d.cssURL,function(){var b="",d=this;location&&(b=location.href),this.movePage(d.barHeight),this.frame.body.innerHTML='                <div id="wrapper">                    <a href="https://fanyi.youdao.com/web2/?keyfrom=headerLogo" target="_blank">                        <h1 id="headerLogo" class="logo"></h1>                    </a>                    <div id="sliderLabel">翻译级别</div>                    <div id="sliderWrapper" class="slider-wrapper">                        <div id="levelLabel">                            <label id="level-3" rel="0"><a>专&nbsp;&nbsp;&nbsp;家</a></label>                            <label id="level-2" rel="1"><a>进&nbsp;&nbsp;&nbsp;阶</a></label>                            <label id="level-1" rel="2"><a>入&nbsp;&nbsp;&nbsp;门</a></label>                            <label id="level-0" rel="3"><a>全文翻译</a></label>                        </div>                        <div id="sliderContainer" class="slider-container">                            <div id="sliderBackground"><div class="slider-background"></div></div>                            <a id="slider" href="javascript:void(0);" class="slider"></a>                        </div>                    </div>                    <div id="status"></div>                    <div id="feedback">                        <a href="https://feedback.youdao.com/quality_report.jsp?q=jtr&prodtype=fanyi&cmt='+encodeURIComponent("我在网站 "+b+" 使用有道网页翻译2.0时，遇到了以下问题：")+'" target="_blank">意见与反馈</a>                        &nbsp;<a id="fb" href="https://survey2.163.com/html/fanyiweb2s201103/paper.html" target="_blank">参加问卷调查</a>                    </div>                    <div id="switchWrapper"><a id="switch" href="javascript:void(0);"></a></div>                </div>                <a id="OUTFOX_JTR_BAR_CLOSE" href="javascript:void(0);" class="OUTFOX_JTR_BAR_CLOSE"></a>                <div id="OUTFOX_JTR_BAR_UPDATE_SHADE"></div>                <div id="OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP">                    <div id="OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP_CONTENT"></div>                </div>',this.initTipContent(),this.initBarClose(),this.initSwitch(),this.initSlider(),this.initLabel(),this.initTipsCtrl(),this.initTransTip(),this.initSwipe();var e=function(b){d.loadSetting(b),d.enable(),d.writeSettings({runCount:d.settings.runCount+1}),a.each(c,function(a,b){d.mode===b[0]&&d.level===b[1]&&d.slider.to(a)})};this.conn.ajax({handler:"localStorage",data:{key:"settings"},dataType:"json",callback:function(a){e(a)}})})},a.TR.UI.prototype={positionElementInViewPort:function(b){var c=b.tip,d=b.target,e=!("static"===a.css(document.body,"position")),f=a.css(document.body,"marginLeft"),g=a.css(document.body,"marginRight");if("auto"===f&&"auto"===g){var h=a.getPageSize().page.width,i=parseInt(a.css(document.body,"width"));f=h>i?(h-i)/2:0}f=e?parseInt(f):0;var j=e?parseInt(a.css(document.body,"marginTop")):0,k=a.findPos(d),l=0,m=0,n=a.scroll().top,o=a.scroll().left,p=k.x,q=k.y,r=d.offsetHeight,s=c.clientHeight,t=c.clientWidth,u=(a.getPageSize().window.height,a.getPageSize().window.width);l=q-s>=n+this.barHeight?q-s:q+r,m=u+o>=p+t?p:u+o-t,a.css(b.tip,{position:"absolute",top:l-j+"px",left:m-f+"px"})},disable:function(){this.changeMode("NONE","NONE"),this.slider.disable(),this.frame.body.className="disable",this.disabled=!0,this.updateStatus(),this.switchElem.innerHTML="重新翻译"},enable:function(){this.changeMode(this.settings.mode,this.settings.level),this.slider.enable(),a.removeClass(this.frame.body,"disable"),a.addClass(this.frame.body,"enable"),this.disabled=!1,this.updateStatus(),this.switchElem.innerHTML="取消翻译"},_trStatusChangeCallback:function(a){if(a.id&&a.action&&a.level){var b=this.queue[a.action][a.level];b.currentThread<=a.id&&(b.currentThread=a.id,b.status=a.status,b.data=a.data||null,a.action===this.mode&&a.level===this.level&&this.updateStatus())}},updateStatus:function(){var b=this.queue[this.mode][this.level];if(a.removeClass(this.statusElem.parentNode,"statistic"),"busy"===b.status&&b.data){this.switchElem.style.visibility="hidden";var c=parseInt(100*b.data[0]/b.data[1],10);this.statusElem.innerHTML="TRANS"===this.mode?"正在翻译&nbsp;"+c+"%&nbsp;...":"正在分析&nbsp;"+c+"%&nbsp;...",this.statusElem.className="busy"}else if("finish"===b.status){if(this.switchElem.style.visibility="inherit","TRANS"===this.mode)this.statusElem.innerHTML="翻译完成";else{var d=this.manager.countTips(this.level);0!==d?(a.addClass(this.statusElem.parentNode,"statistic"),this.statusElem.innerHTML='共注释<span class="OUTFOX_BAR_TOTAL_NUM">'+d+"</span>个难词"):this.statusElem.innerHTML="恭喜您！该网页上没有难词~"}this.statusElem.className="finish"}else this.switchElem.style.visibility="inherit",this.statusElem.innerHTML="翻译助手已关闭",this.statusElem.className="finish"},initLogger:function(a){this.logURL=a,this._logImgCache=[]},log:function(b){if(this.logURL){b.relatedURL=document.location.href,b.guid=this.guid;var c=new Image;c.src=this.logURL+"?"+a.param(b)+"&"+(new Date).getTime(),this._logImgCache[this._logImgCache.length]=c}},initSwipe:function(){var b=this;this.swipe=a.Swipe(this.context,this.conn),this.swipe.onSwipeCallback=function(a){b.log({action:"swipeWord",word:a})}},movePage:function(b){if(a.browser.msie){var c=a.css(this.context,"paddingTop");try{c=parseInt(c)}catch(d){c=0}this.context.style.cssText+=";padding-top:"+(b+c)+"px !important;"}else{var e=a.css(this.context,"marginTop");try{e=parseInt(e)}catch(d){e=0}"static"===a.css(this.context,"position")&&a.css(this.context,{position:"relative"}),this.context.style.cssText+=";margin-top:"+(b+e)+"px !important;"}},initFrame:function(b,c){function d(b){b.innerHTML='<iframe id="OUTFOX_JTR_BAR" src="" style="display:none;"></iframe>';var c=a.query("#OUTFOX_JTR_BAR");return c.setAttribute("frameBorder",0),a.browser.msie&&document.domain!=window.location.hostname&&(c.src="javascript:void(document.write(\"<script>document.domain='"+document.domain+"';</script><body></body>\"))"),!a.browser.msie||"8.0"===a.browser.msie&&"CSS1Compat"===document.compatMode||(a.css(c,{width:a.getPageSize().window.width+"px"}),a.bind(window,"resize",function(){a.css(c,{width:a.getPageSize().window.width+"px"})})),c}var e=this,f=document.createElement("div");f.id="OUTFOX_BAR_WRAPPER",this.context.appendChild(f),this.wrapper=f;var g=d(f);this.iframe=g,setTimeout(function(){try{e.frame=g.contentDocument||g.contentWindow.document}catch(d){return e.log({action:"secRestrict",relatedURL:window.location.href}),void alert(e.permissionDenied)}a.css(g,{display:"block"}),a.addClass(g,"OUTFOX_JTR_BAR"),a.loadCSS(e.frame,b),e.frame.body.id="OUTFOX_JTR_BAR_BODY",a.addClass(e.frame.body,"forbid-select"),e.frame.body.onselectstart=e.frame.body.ondrag=function(){return!1},c.call(e)},100)},initBarClose:function(){var b=this,c=this.frame.getElementById("OUTFOX_JTR_BAR_CLOSE");a.addClass(c,"OUTFOX_JTR_BAR_CLOSE"),a.bind(window,"resize",function(){a.css(c,{top:"1px",right:"1px"})}),a.bind(c,"click",function(){b.disable(),b.movePage(-b.barHeight),b.context.removeChild(b.wrapper),b.context.removeChild(a.query("#OUTFOX_JTR_CDA")),b.context.removeChild(a.query("#yddWrapper")),b.context.removeChild(a.query("#outfox_seed_js"))})},initTipContent:function(){if(this.update){var b=this,c=function(){var c=a.query("#OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP_CONTENT",b.frame),d=a.query("#OUTFOX_JTR_BAR_UPDATE_SHADE",b.frame),e=a.query("#OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP",b.frame);c.innerHTML="更新提示：<br/>"+b.updateTipMsg+'<span class="update-date">'+b.updateDate+'</span><a href="javascript:void(0);" id="OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP_CONTENT_CLOSE"></a>';var f=a.query("#OUTFOX_JTR_BAR_CLOSE_UPDATE_TIP_CONTENT_CLOSE",b.frame);a.css(d,{display:"block"}),a.css(e,{display:"block"}),a.bind(f,"click",function(){a.css(d,{display:"none"}),a.css(e,{display:"none"})})};b.conn.ajax({handler:"localStorage",data:{key:"date"},callback:function(a){a!==b.updateDate&&(c(),b.conn.ajax({handler:"localStorage",data:{key:"date",value:b.updateDate}}))}})}},initSwitch:function(){var b=this;this.statusElem=a.query("#status",this.frame),this.switchElem=a.query("#switch",this.frame),a.bind(this.switchElem,"click",function(){b.disabled?b.enable():b.disable()})},initLabel:function(){this.labels=[];for(var b=this,d=function(d){var e=d||window.event,f=e.target||e.srcElement,g=f.parentNode.getAttribute("rel");b.disabled||g&&(b.changeMode(c[g][0],c[g][1]),a.each(c,function(a,c){b.mode===c[0]&&b.level===c[1]&&b.slider.to(a)}))},e=0;4>e;e++)this.labels[e]=a.query("#level-"+e,this.frame),a.bind(this.labels[e],"click",d)},initSlider:function(){var b=a.query("#sliderContainer",this.frame),c=a.query("#slider",this.frame),d=this,e=null,f=10;this.slider=new a.Slider(b,c,{bar:a.query("#sliderBackground",this.frame),max:3,min:0,step:1,borderFix:-3,callback:function(a){clearTimeout(e),e=setTimeout(function(){d._valueChange(a)},f)}})},loadSetting:function(c){var d={};if(null===c||"[object Object]"!==Object.prototype.toString.call(c))this.conn.ajax({handler:"localStorage",dataType:"json",data:{key:"settings",value:JSONDAO.stringify(b)}}),d=b;else for(var e in b)b.hasOwnProperty(e)&&(d[e]=c.hasOwnProperty(e)?c[e]:b[e]);d.mode=d.mode||b.mode,d.level=d.level||b.level,a.log("Load Settings:",d),this.settings=d},_valueChange:function(a){var b=Math.round(a),d=c[b][0],e=c[b][1];d!==this.mode?this.changeMode(d,e):e!==this.level&&this.changeLevel(e)},changeMode:function(a,b){if("TIPS"===this.mode){for(var c=1;3>=c;c++)this.labels[c].className="deactive";this.translator.revertTips()}else"TRANS"===this.mode&&(this.labels[0].className="deactive",this.translator.revertTrans());this.swipe.disableSwipe(),this.disableTransTip(),this.disableTipsCtrl(),this.mode=a,this.changeLevel(b)},changeLevel:function(b){if(a.log("Change level to:",b),this.log(null===this.level?{action:"view",level:b}:{action:"changeLevel",oldLevel:this.level,newLevel:b}),this.level=b,"TIPS"===this.mode){this.swipe.enableSwipe();for(var c=1;3>=c;c++)this.labels[c].className=c==b?"active":"deactive";this.translator.revertTips(),this.translator.doTips(this.level),this.enableTipsCtrl()}else"TRANS"===this.mode&&(this.labels[0].className="active",this.translator.doTrans(),this.enableTransTip());"NONE"!==this.mode&&this.writeSettings({mode:this.mode,level:this.level})},writeSettings:function(b){a.each(b,function(a,b){this.settings[a]=b},this),this.conn.ajax({handler:"localStorage",dataType:"json",data:{key:"settings",value:JSONDAO.stringify(this.settings)}})},initTipsCtrl:function(){var b=this,c=this.initTipsCtrlElem(),d=null;this.tipsTarget=null,this.tipsCtrlHandler=function(e){var f=e||window.evt,g=f.target||f.srcElement;clearTimeout(d),g===b.tipsTarget||g.className&&-1!==g.className.indexOf("OUTFOX_JTR_NANCI_")||(d=setTimeout(function(){if(c.parentNode&&c.parentNode.removeChild(c),a.hasClass(g,"OUTFOX_NANCI_TIPS")){var d=a.findPos(g),e=a.query(".OUTFOX_JTR_NANCI_CTRL_WORD",c)[0];b.context.appendChild(c),e.innerHTML=g.innerHTML;var f=a.css(g,"fontSize"),h=a.css(g,"fontFamily");try{-1!=f.indexOf("em")||parseInt(f)<12&&(f="12px")}catch(i){f="12px"}var j=!("static"===a.css(document.body,"position")),k=a.css(document.body,"marginLeft"),l=a.css(document.body,"marginRight");if("auto"===k&&"auto"===l){var m=a.getPageSize().page.width,n=parseInt(a.css(document.body,"width"));k=m>n?(m-n)/2:0}k=j?parseInt(k):0;var o=j?parseInt(a.css(document.body,"marginTop")):0;a.css(e,{fontSize:f}),a.css(e,{fontFamily:h}),a.css(c,{left:d.x-k+"px",top:d.y-o+"px",position:"absolute"}),b.tipsTarget=g}else b.tipsTarget=null},200))}},initTipsCtrlElem:function(){var b=document.createElement("span"),c=document.createElement("span"),d=document.createElement("a"),e=document.createElement("span"),f=document.createElement("a"),g=document.createElement("span"),h=this;g.className="OUTFOX_JTR_NANCI_CTRL_WORD",b.appendChild(g),d.className="OUTFOX_JTR_NANCI_CTRL_DETAIL",d.setAttribute("title","查看详细解释"),d.innerHTML="详解",c.appendChild(d),c.className="OUTFOX_JTR_NANCI_CTRL_DETAIL_BG",b.appendChild(c),f.className="OUTFOX_JTR_NANCI_CTRL_CLOSE",f.setAttribute("title","我知道了"),f.innerHTML="关闭",e.appendChild(f),e.className="OUTFOX_JTR_NANCI_CTRL_CLOSE_BG",b.appendChild(e),b.className="OUTFOX_JTR_NANCI_BAR";var i=function(){var a=null;try{a=h.tipsTarget.previousSibling}catch(b){}return a},j=function(a){var b=null;if(document.createRange){var c=window.getSelection();b=document.createRange(),c.removeAllRanges(),b.selectNode(a),c.addRange(b)}else document.body.createTextRange&&(b=document.body.createTextRange(),b.moveToElementText(a),b.select())};return a.bind(d,"click",function(){var c=i();if(c&&h.swipe){h.log({action:"viewDetail",word:c.innerHTML}),j(c);var d=document.createElement("font");d.innerHTML="&nbsp",c.appendChild(d);var e=a.findPos(d),f=d.offsetHeight;c.removeChild(d),h.swipe.swipeWord(c.firstChild.nodeValue,e.x,e.y,0,f)}b.parentNode.removeChild(b),a.removeClass(h.tipsTarget,"on")}),a.bind(f,"click",function(){var c=(b.getAttribute("rel"),i());c&&(h.log({action:"closeTip",word:c.innerHTML,tip:h.tipsTarget.innerHTML}),h.translator._manager.revertTip(c)),b.parentNode.removeChild(b),a.removeClass(h.tipsTarget,"on")}),b},_findTipCtrlPosition:function(b,c){var d=b.firstChild,e=d.nodeValue,f=d.nodeValue.length,g=document.createElement("font"),h=document.createTextNode(""),i=[0,0],j=null,k=null,l=null,m=0,n=0,o=0,p=f,q=null;a.css(g,{border:"none",padding:0,margin:0});for(var r=0;f>=r;r++)h.nodeValue=d.nodeValue.substr(r),d.nodeValue=d.nodeValue.substr(0,r),b.insertBefore(h,d.nextSibling),b.insertBefore(g,d.nextSibling),l=a.findPos(g),m=l.x-c[0],n=l.y-c[1],0>=n&&(null===k||n>k)&&(q=k=n,i[0]=l.x,i[1]=l.y,j=null,o=r),n!==q&&(p=r,q=n),d.nodeValue=e,b.removeChild(h),b.removeChild(g);return g.innerHTML=d.nodeValue.substr(o,p),d.nodeValue=d.nodeValue.substr(0,o),b.insertBefore(g,d.nextSibling),i[0]+=g.offsetWidth,b.removeChild(g),d.nodeValue=e,i},preventClose:function(){a.css(a.query("#OUTFOX_JTR_BAR_CLOSE",this.frame),{display:"none"})},enableTipsCtrl:function(){a.bind(this.context,"mouseover",this.tipsCtrlHandler)},disableTipsCtrl:function(){a.unbind(this.context,"mouseover",this.tipsCtrlHandler)},enableTransTip:function(){a.bind(this.context,"mouseover",this.transTipHandler)},disableTransTip:function(){a.unbind(this.context,"mouseover",this.transTipHandler)},initTransTip:function(){var b=this,c=null,d=null;this.initTransTipElem("",""),this.transTipHandler=function(e){var f=e||window.event,g=f.target||f.srcElement;clearTimeout(d),d=setTimeout(function(){if(c!==g&&(!g.className||-1===g.className.indexOf("OUTFOX_JTR_TRANSTIP_")&&-1===g.className.indexOf("ydd-")))if(c&&(c.style.textDecoration="none"),b.transTipElem.elem.parentNode&&b.transTipElem.elem.parentNode.removeChild(b.transTipElem.elem),a.hasClass(g,"OUTFOX_JTR_TRANS_NODE")){c=g;var d=g.getAttribute("rel"),e=b.translator._manager;b.resetTransTipElem(e.originals[d],e.transResults[d],d),b.context.appendChild(b.transTipElem.elem),b.positionElementInViewPort({target:g,tip:b.transTipElem.elem}),g.style.textDecoration="underline"}else c=null},200)}},initTransTipElem:function(){var b=this,c=document.createElement("div");c.className="OUTFOX_JTR_TRANSTIP_WRAPPER";var d=document.createTextNode(""),e=document.createTextNode("");c.innerHTML+='<div class="OUTFOX_JTR_TRANSTIP_ORIGIN">                                        <div class="ydd-container">                                          <div class="ydd-top-wrapper">                                            <div class="ydd-top">                                            </div>                                          </div>                                          <div class="ydd-body-wrapper">                                            <div class="ydd-lb"></div>                                            <div class="ydd-rb"></div>                                            <div class="ydd-body">                                              <div class="ydd-title">                                                <strong>原文：</strong>                                              </div>                                              <div class="ydd-middle">                                                <div class="OUTFOX_JTR_TRANSTIP_ORIGIN_TEXT"></div>                                                <div class="OUTFOX_JTR_TRANSTIP_ADVISE">                                                  <textarea class="OUTFOX_JTR_TRANSTIP_ADVISE_TEXT"></textarea>                                                  <a class="OUTFOX_JTR_TRANSTIP_ADVISE_SUBMIT" href="javascript:void(0);">提交翻译建议</a>                                                </div>                                              </div>                                            </div>                                          </div>                                          <div class="ydd-bottom-wrapper">                                            <div class="ydd-bottom">                                              <a class="OUTFOX_JTR_TRANSTIP_ADVISE_TOGGLE">更好的翻译建议</a>                                              <span class="OUTFOX_JTR_TRANSTIP_ADVISE_THANK">感谢您为有道提供建议^_^</span>                                            </div>                                          </div>                                          <div class="ydd-bg-top"></div>                                        </div>                                      </div>',a.query(".OUTFOX_JTR_TRANSTIP_ORIGIN_TEXT",c)[0].appendChild(e),a.query(".OUTFOX_JTR_TRANSTIP_ADVISE_TEXT",c)[0].appendChild(d);var f=a.query(".OUTFOX_JTR_TRANSTIP_ADVISE_TOGGLE",c)[0],g=a.query(".OUTFOX_JTR_TRANSTIP_ADVISE_SUBMIT",c)[0],h=a.query(".OUTFOX_JTR_TRANSTIP_ADVISE",c)[0],i=a.query(".ydd-bottom",c)[0],j=a.query(".OUTFOX_JTR_TRANSTIP_ADVISE_TEXT",c)[0];g.hideFocus=!0,a.bind(f,"click",function(){a.toggleClass(h,"expand"),a.css(f,{display:"none"})});var k=function(a){return a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;")};a.bind(g,"click",function(){var c=j.value;if(""===c)return void alert("翻译建议不能为空，请您输入内容后再次提交");c=k(c),a.addClass(h,"finish"),a.removeClass(h,"expand"),a.addClass(i,"OUTFOX_JTR_TRANSTIP_ADVISE_THANK_TIP");var d=b.transTipElem.index;d&&b.manager.transResults[d]&&(b.manager.transResults[d]=c,b.manager.revertTrans(d),b.manager.replaceTrans(d))}),this.transTipElem={elem:c,transTextContainer:j,trans:d,original:e,toggle:f,submit:g,advise:h,bottom:i,index:null}},resetTransTipElem:function(b,c,d){a.removeClass(this.transTipElem.advise,"finish"),a.removeClass(this.transTipElem.advise,"expand"),a.removeClass(this.transTipElem.bottom,"OUTFOX_JTR_TRANSTIP_ADVISE_THANK_TIP"),this.transTipElem.toggle.innerHTML="提交翻译建议",a.css(this.transTipElem.toggle,{display:""}),this.transTipElem.transTextContainer.value=c,this.transTipElem.original.nodeValue=b,this.transTipElem.index=d}}}(J),function(a){var b="https://fanyi.youdao.com/web2",c="https://fanyi.youdao.com",d="/web2/conn.html",e=b+"/index.do",f=c+"/jtr",g=b+"/rl.do",h=b+"/styles/all-packed.css";a.loadCSS(document,h),window.OUTFOX_JavascriptTranslatoR=new a.TR.UI(document.body,{domain:c,update:!1,updateTipMsg:"修复链接错误",updateDate:"2013-12-24",cssURL:h,tipsURL:e,transURL:f,logURL:g,connFilePath:d,reqSize:20})}(J);